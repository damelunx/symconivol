<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Studying curvature measures of symmetric cones - Technical details â€¢ symconivol</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Studying curvature measures of symmetric cones - Technical details">
<meta property="og:description" content="">
<meta property="og:image" content="http://damelunx.github.io/symconivol/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">symconivol</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/symconivol.html">Introduction</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Study
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/curv_meas.html">Main</a>
    </li>
    <li>
      <a href="../articles/curv_meas_tech.html">Technical addendum</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li>
  <a href="https://github.com/damelunx/symconivol">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Studying curvature measures of symmetric cones - Technical details</h1>
                        <h4 class="author">Dennis Amelunxen</h4>
            
            <h4 class="date">15 February, 2018</h4>
          </div>

    
    
<div class="contents">
<p>This note contains technical details to the vignette <a href="curv_meas.html">Studying curvature measures of symmetric cones</a>. More precisely, we will provide the code that generates those plots, which are only included as image files and not created in the markdown file.</p>
<p><strong>Packages used:</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(symconivol)
<span class="kw">library</span>(conivol)
<span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(knitr)
<span class="kw">library</span>(Rmisc)
<span class="kw">library</span>(rstan)
<span class="kw">library</span>(png)
<span class="kw">library</span>(latex2exp)</code></pre></div>
<p><strong>Sampling index constrained eigenvalues:</strong> In the following lines we construct Stan models for index constrained eigenvalues, run the models to obtain ten thousand sample points for each model, and save these sample points in correspondingly named files.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">warmup &lt;-<span class="st"> </span><span class="fl">1e3</span>
num_samp &lt;-<span class="st"> </span><span class="fl">1e5</span>
fname_model &lt;-<span class="st"> "tmp.stan"</span>

<span class="co"># define the number of negative, free, positive eigenvalues</span>
nn_nf_np_list &lt;-<span class="st"> </span><span class="kw">tribble</span>(~nn, ~nf, ~np,
                           <span class="dv">5</span>,  <span class="dv">10</span>,  <span class="dv">25</span>,
                           <span class="dv">0</span>,  <span class="dv">15</span>,  <span class="dv">25</span>,
                           <span class="dv">2</span>,   <span class="dv">0</span>,   <span class="dv">8</span>,
                           <span class="dv">4</span>,   <span class="dv">0</span>,   <span class="dv">6</span>,
                           <span class="dv">8</span>,   <span class="dv">0</span>,  <span class="dv">32</span>,
                          <span class="dv">16</span>,   <span class="dv">0</span>,  <span class="dv">24</span>,
                          <span class="dv">35</span>,   <span class="dv">5</span>,   <span class="dv">0</span>,
                          <span class="dv">20</span>,   <span class="dv">0</span>,   <span class="dv">0</span>,
                           <span class="dv">0</span>,  <span class="dv">10</span>,   <span class="dv">0</span>,
                           <span class="dv">0</span>,  <span class="dv">40</span>,   <span class="dv">0</span>,
                           <span class="dv">0</span>,   <span class="dv">0</span>,  <span class="dv">40</span>)

for (i in <span class="dv">1</span>:<span class="kw">length</span>(nn_nf_np_list)) {
    nn &lt;-<span class="st"> </span>nn_nf_np_list$nn[i]
    nf &lt;-<span class="st"> </span>nn_nf_np_list$nf[i]
    np &lt;-<span class="st"> </span>nn_nf_np_list$np[i]
    
    <span class="co"># construct the Stan model file</span>
    <span class="kw"><a href="../reference/constr_eigval.html">constr_eigval</a></span>(<span class="dt">pos=</span>(np&gt;<span class="dv">0</span>), <span class="dt">free=</span>(nf&gt;<span class="dv">0</span>), <span class="dt">neg=</span>(nn&gt;<span class="dv">0</span>), <span class="dt">filename=</span>fname_model)
    for (beta in <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>)) {
        fname_evals &lt;-<span class="st"> </span><span class="kw">str_c</span>(<span class="st">"evals_beta_nn_nf_np_N="</span>,beta,<span class="st">"_"</span>,nn,<span class="st">"_"</span>,nf,
                             <span class="st">"_"</span>,np,<span class="st">"_"</span>,num_samp,<span class="st">"_wmup="</span>,warmup,<span class="st">".RData"</span>)
        data =<span class="st"> </span><span class="kw">list</span>(<span class="dt">beta=</span>beta)
        if (np&gt;<span class="dv">0</span>) data$np &lt;-<span class="st"> </span>np
        if (nf&gt;<span class="dv">0</span>) data$nf &lt;-<span class="st"> </span>nf
        if (nn&gt;<span class="dv">0</span>) data$nn &lt;-<span class="st"> </span>nn
        
        <span class="co"># run the Stan model</span>
        stan_samp &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/rstan/topics/stan">stan</a></span>( <span class="dt">file=</span>fname_model, <span class="dt">data=</span>data, <span class="dt">chains=</span><span class="dv">1</span>, <span class="dt">warmup=</span>warmup,
                           <span class="dt">iter=</span>num_samp+warmup, <span class="dt">cores=</span><span class="dv">2</span>, <span class="dt">refresh=</span><span class="fl">1e4</span> )
        
        <span class="co"># extract the sample points</span>
        samp &lt;-<span class="st"> </span><span class="kw">list</span>()
        if (np&gt;<span class="dv">0</span>) samp$ep &lt;-<span class="st"> </span>rstan::<span class="kw"><a href="http://www.rdocumentation.org/packages/rstan/topics/stanfit-method-extract">extract</a></span>(stan_samp)$ep
        if (nf&gt;<span class="dv">0</span>) samp$ef &lt;-<span class="st"> </span>rstan::<span class="kw"><a href="http://www.rdocumentation.org/packages/rstan/topics/stanfit-method-extract">extract</a></span>(stan_samp)$ef
        if (nn&gt;<span class="dv">0</span>) samp$en &lt;-<span class="st"> </span>rstan::<span class="kw"><a href="http://www.rdocumentation.org/packages/rstan/topics/stanfit-method-extract">extract</a></span>(stan_samp)$en
        
        <span class="kw">save</span>(samp, <span class="dt">file=</span>fname_evals)
    }
    <span class="kw">file.remove</span>(fname_model)
}</code></pre></div>
<p><strong>Plots of empirical distribution of index constrained eigenvalues:</strong> The following lines produce the plots of the empirical distribution of the index constrained eigenvalues sampled above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">colors &lt;-<span class="st"> </span><span class="kw">hcl</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dv">15</span>, <span class="dv">375</span>, <span class="dt">length=</span><span class="dv">4</span>), <span class="dt">l =</span> <span class="dv">65</span>, <span class="dt">c =</span> <span class="dv">100</span>)[<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>)]
ymax &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.18</span>,<span class="fl">0.16</span>,<span class="fl">0.16</span>,<span class="fl">0.24</span>,<span class="fl">0.6</span>,<span class="fl">0.5</span>,<span class="fl">0.083</span>,<span class="dv">0</span>,<span class="kw">rep</span>(<span class="fl">0.9</span>,<span class="dv">2</span>),<span class="kw">rep</span>(<span class="fl">1.3</span>,<span class="dv">2</span>))

for (i in <span class="dv">1</span>:<span class="kw">dim</span>(nn_nf_np_list)[<span class="dv">1</span>]) {
    nn &lt;-<span class="st"> </span>nn_nf_np_list[[i,<span class="dv">1</span>]]
    nf &lt;-<span class="st"> </span>nn_nf_np_list[[i,<span class="dv">2</span>]]
    np &lt;-<span class="st"> </span>nn_nf_np_list[[i,<span class="dv">3</span>]]
    n &lt;-<span class="st"> </span>nn+nf+np
    plotsPB &lt;-<span class="st"> </span><span class="kw">list</span>()
    j &lt;-<span class="st"> </span><span class="dv">0</span>
    for (beta in <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>)) {
        j &lt;-<span class="st"> </span>j<span class="dv">+1</span>
        fname_evals &lt;-<span class="st"> </span><span class="kw">str_c</span>(<span class="st">"evals_beta_nn_nf_np_N="</span>,beta,<span class="st">"_"</span>,nn,<span class="st">"_"</span>,nf,
                             <span class="st">"_"</span>,np,<span class="st">"_"</span>,num_samp,<span class="st">"_wmup="</span>,warmup,<span class="st">".RData"</span>)
        <span class="kw">load</span>(<span class="dt">file=</span>fname_evals)
        tmp &lt;-<span class="st"> </span><span class="kw">tibble</span>()
        if (np&gt;<span class="dv">0</span>) tmp &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(tmp,samp$ep %&gt;%<span class="st"> </span><span class="kw">as_tibble</span>() %&gt;%<span class="st"> </span><span class="kw">gather</span>(<span class="dt">factor_key=</span><span class="ot">TRUE</span>) %&gt;%<span class="st"> </span><span class="kw">add_column</span>(<span class="dt">type=</span><span class="st">"0"</span>))
        if (nf&gt;<span class="dv">0</span>) tmp &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(tmp,samp$ef %&gt;%<span class="st"> </span><span class="kw">as_tibble</span>() %&gt;%<span class="st"> </span><span class="kw">gather</span>(<span class="dt">factor_key=</span><span class="ot">TRUE</span>) %&gt;%<span class="st"> </span><span class="kw">add_column</span>(<span class="dt">type=</span><span class="st">"1"</span>))
        if (nn&gt;<span class="dv">0</span>) tmp &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(tmp,samp$en %&gt;%<span class="st"> </span><span class="kw">as_tibble</span>() %&gt;%<span class="st"> </span><span class="kw">gather</span>(<span class="dt">factor_key=</span><span class="ot">TRUE</span>) %&gt;%<span class="st"> </span><span class="kw">add_column</span>(<span class="dt">type=</span><span class="st">"2"</span>))
        this_colors &lt;-<span class="st"> </span>colors[<span class="kw">c</span>(np&gt;<span class="dv">0</span>,nf&gt;<span class="dv">0</span>,nn&gt;<span class="dv">0</span>)]
        plotsPB[[j]] &lt;-<span class="st"> </span><span class="kw">ggplot</span>() +
<span class="st">            </span><span class="kw">geom_density</span>(<span class="dt">data=</span>tmp, <span class="kw">aes</span>(<span class="dt">x=</span>value, <span class="dt">y=</span>..count.., <span class="dt">group=</span>type, <span class="dt">color=</span>type, <span class="dt">fill=</span>type), <span class="dt">alpha=</span><span class="fl">0.5</span>, <span class="dt">bw=</span><span class="fl">0.03</span>) +
<span class="st">            </span><span class="kw">theme_bw</span>() +<span class="st"> </span><span class="kw">xlab</span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/latex2exp/topics/TeX">TeX</a></span>(<span class="kw">sprintf</span>(<span class="st">"$</span><span class="ch">\\</span><span class="st">beta = %d$"</span>, beta))) +
<span class="st">            </span><span class="kw">theme</span>(<span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),
                  <span class="dt">axis.text.y=</span><span class="kw">element_blank</span>(), <span class="dt">axis.ticks.y=</span><span class="kw">element_blank</span>(),
                  <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),
                  <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(), <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">"black"</span>)) +
<span class="st">            </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, ymax[i]/<span class="kw">sqrt</span>(beta)*num_samp*n)) +
<span class="st">            </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">"none"</span>) +
<span class="st">            </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span>this_colors) +<span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span>this_colors)
    }
    plotFileName &lt;-<span class="kw">str_c</span>(<span class="st">"curv-meas_figures/"</span>,
                         <span class="st">"nn_nf_np="</span>,nn,<span class="st">"_"</span>,nf,<span class="st">"_"</span>,np,<span class="st">".png"</span>)
    <span class="kw">ggsave</span>(plotFileName, <span class="dt">plot=</span><span class="kw"><a href="http://www.rdocumentation.org/packages/Rmisc/topics/multiplot">multiplot</a></span>(<span class="dt">plotlist =</span> plotsPB, <span class="dt">cols =</span> <span class="dv">3</span>), <span class="dt">device=</span><span class="st">"png"</span>,
           <span class="dt">width=</span><span class="dv">178</span>, <span class="dt">height=</span><span class="dv">80</span>, <span class="dt">units=</span><span class="st">"mm"</span>, <span class="dt">dpi=</span><span class="dv">300</span>)
}</code></pre></div>
<p><strong>Reconstructing index normalized curvature measures:</strong></p>
<p><strong>Reconstructing dimension normalized curvature measures:</strong></p>
<p><strong>Plots of empirical distribution of index constrained eigenvalues:</strong></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Dennis Amelunxen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
